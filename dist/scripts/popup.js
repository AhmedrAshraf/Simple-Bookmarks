$(function(){"use strict";function a(a){a.sublistEl&&(a.isOpen=!a.isOpen,a.sublistEl.slideToggle(),a.el.toggleClass("open"))}function b(a){var b,c=$('<li class="bm-item"></li>'),d=$('<a class="bm-item-title">'+a.title+"</a>"),e=$('<i class="bm-item-favicon"></i>');return c.append(d.prepend(e)),c.attr({id:"bmitem-"+a.id,"data-id":a.id,"data-index":a.index}),c.addClass(a.children?"bm-item-directory":"bm-item-bookmark"),d.attr({href:a.url||"javascript:"}),a.url&&e.append('<img src="chrome://favicon/'+a.url+'">'),b={id:a.id,el:c,data:a},g[a.id]=b,b}function c(a){var b=$('<ul class="bm-sublist"></ul>');return a.el.append(b),a.sublistEl=b,a.isOpen!==!0&&b.css("display","none"),b}function d(a,e){function h(){j?(j.sublistEl||c(j),j.sublistEl.append(a.el)):f.append(a.el)}var i=a.data.parentId,j=g[i];!j&&e?chrome.bookmarks.get(i+"",function(c){var f=c&&c[0];f&&simpleBookmarks.isCorrectNode(f)&&(j=b(f),d(a,e)),h()}):h()}var e=$(document),f=$("#bookmarks"),g={};simpleBookmarks.traversalBookmarks(function(a){var c=b(a);d(c,!0)}),e.on("click",".bm-item-title",function(b){var c,d=$(this).closest(".bm-item"),e=g[d.attr("data-id")],f=b.ctrlKey||b.metaKey,h=b.shiftKey;return d.hasClass("bm-item-directory")?a(e):d.hasClass("bm-item-bookmark")&&(c=e.data.url,f?simpleBookmarks.openBookmarksNewTab(c,!0):h?simpleBookmarks.openBookmarksNewWindow(c):simpleBookmarks.openBookmarkCurrentTab(c,!0)),!1})});