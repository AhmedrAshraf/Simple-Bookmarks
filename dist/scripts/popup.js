$(function(){"use strict";function a(a,d){d||!a.isOpen?b(a):c(a)}function b(a){a.isOpen=!0,a.el.addClass("open"),a.sublistEl&&a.sublistEl.slideDown()}function c(a){a.isOpen=!1,a.el.removeClass("open"),a.sublistEl&&a.sublistEl.slideUp()}function d(a){var b,c;return a.title?(a.children?b=e(a):"-----"===a.title.replace(k,"").substring(0,5)?b=g(a):a.url&&(b=f(a)),c={id:a.id,el:b,data:a},n[a.id]=c,c):null}function e(a){return $('<li id="bmitem-'+a.id+'" class="bm-item bm-item-directory" data-id="'+a.id+'" data-index="'+a.index+'"><span class="bm-item-title"><i class="bm-item-favicon"></i>'+a.title+"</span></li>")}function f(a){return $('<li id="bmitem-'+a.id+'" class="bm-item bm-item-bookmark" data-id="'+a.id+'" data-index="'+a.index+'"><a class="bm-item-title" href="'+a.url+'"><i class="bm-item-favicon"><img src="chrome://favicon/'+a.url+'" /></i>'+a.title+"</a></li>")}function g(a){var b=a.title.replace(l,"");return $('<li id="bmitem-'+a.id+'" class="bm-item bm-item-separator" data-id="'+a.id+'" data-index="'+a.index+'"><span class="bm-item-title"><span class="line"></span><span class="text">'+b+"</span></span></li>")}function h(a){var b=$('<ul class="bm-sublist"></ul>');return a.el.append(b),a.sublistEl=b,a.isOpen!==!0&&b.css("display","none"),b}function i(a,b){function c(){f?(f.sublistEl||h(f),f.sublistEl.append(a.el)):m.append(a.el)}if(a){var e=a.data.parentId,f=n[e];!f&&b?chrome.bookmarks.get(e+"",function(e){var g=e&&e[0];g&&simpleBookmarks.isCorrectNode(g)&&(f=d(g),i(a,b)),c()}):c()}}var j=$(document),k=/\s/g,l=/[\s-]/g,m=$("#bookmarks"),n={};simpleBookmarks.traversalBookmarks(function(a){var b=d(a);i(b,!0)}),j.on("click",".bm-item-title",function(b){var c,d=$(this).closest(".bm-item"),e=n[d.attr("data-id")],f=b.ctrlKey||b.metaKey,g=b.shiftKey;return d.hasClass("bm-item-directory")?a(e):d.hasClass("bm-item-bookmark")&&(c=e.data.url,f?simpleBookmarks.openBookmarksNewTab(c,!0):g?simpleBookmarks.openBookmarksNewWindow(c):simpleBookmarks.openBookmarkCurrentTab(c,!0)),!1})});